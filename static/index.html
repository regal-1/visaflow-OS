<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VisaFlow OS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="header shell">
      <div>
        <h1>VisaFlow OS</h1>
        <p>Adaptive workflow prep for CPT, OPT, STEM OPT, and Cap Gap/H-1B transition</p>
      </div>
      <div class="header-meta">
        <span id="school_label">School: not set</span>
        <span id="flow_label">Path: not started</span>
        <span id="progress_text">Progress: Step 0 of 0</span>
      </div>
    </header>

    <main class="shell">
      <nav class="tabs" aria-label="Workflow Sections">
        <button class="tab active" data-tab="input">1. Intake</button>
        <button class="tab" data-tab="process">2. Plan</button>
        <button class="tab" data-tab="output">3. Output</button>
      </nav>

      <section class="panel active" id="tab-input">
        <div class="grid two">
          <article class="card">
            <h2>Tell Us About Your Case</h2>
            <p class="subtle">Start with your school and current context.</p>
            <div class="form-grid">
              <label>
                School / University
                <input id="school_name_input" placeholder="UCLA, UCB, Cornell, Duke, Yale..." />
              </label>
              <label>
                Current Status
                <select id="status_type_input">
                  <option value="">Select</option>
                  <option value="f1">F-1</option>
                  <option value="opt">OPT</option>
                  <option value="stem_opt">STEM OPT</option>
                </select>
              </label>
              <label>
                Program Stage
                <select id="program_stage_input">
                  <option value="">Select</option>
                  <option value="enrolled">Enrolled</option>
                  <option value="graduating">Graduating</option>
                  <option value="graduated">Graduated</option>
                  <option value="working">Working</option>
                </select>
              </label>
              <label>
                Preferred View
                <select id="preferred_mode">
                  <option value="checklist">Checklist</option>
                  <option value="timeline">Timeline</option>
                  <option value="explain">Explain</option>
                </select>
              </label>
            </div>

            <label>
              Describe your situation
              <textarea id="intent" rows="6" placeholder="Example: I am an F-1 student and got a summer internship, but I do not know whether I need CPT or OPT."></textarea>
            </label>

            <button id="start_btn" class="primary">Generate Plan</button>
          </article>

          <article class="card">
            <h2>Synthetic Demo Cases</h2>
            <p class="subtle">Use one click demo personas for investor walkthroughs.</p>
            <div id="scenario_chips" class="chips"></div>

            <h3>Suggested Paths</h3>
            <ul id="candidate_flows" class="list"></ul>

            <div id="disambiguation_card" class="notice hidden">
              <h3>Choose The Right Path</h3>
              <p id="disambiguation_prompt"></p>
              <div id="disambiguation_options" class="chips"></div>
            </div>
          </article>
        </div>
      </section>

      <section class="panel" id="tab-process">
        <div class="toolbar">
          <div>
            <span id="current_view" class="pill">View: Checklist</span>
            <p id="guidance_text" class="subtle">We will keep this simple and guide one step at a time.</p>
          </div>
          <div class="chips">
            <button class="chip-btn" data-manual-mode="checklist">Checklist</button>
            <button class="chip-btn" data-manual-mode="timeline">Timeline</button>
            <button class="chip-btn" data-manual-mode="explain">Explain</button>
          </div>
        </div>

        <div class="grid two">
          <article class="card">
            <h2>Your Step-by-Step Plan</h2>
            <ul id="workflow_steps" class="list"></ul>
          </article>

          <article class="card">
            <h2>What To Do Next</h2>
            <div class="status-row">
              <span id="status_primary" class="badge">In Progress</span>
              <span id="status_secondary" class="badge muted-badge">Preparing Handoff</span>
            </div>
            <p><strong>Next action:</strong> <span id="next_action">Generate a plan from intake first.</span></p>
            <h3>Still Needed Before Advisor Review</h3>
            <ul id="missing_preview" class="list compact"></ul>
          </article>
        </div>
      </section>

      <section class="panel" id="tab-output">
        <div class="grid two">
          <article class="card">
            <h2>Complete Required Details</h2>
            <p class="subtle">Only fields relevant to your selected path matter.</p>
            <div class="form-grid">
              <label>School Name <input data-field="school_name" class="case-field" /></label>
              <label>Status Type <input data-field="status_type" class="case-field" placeholder="f1 / opt / stem_opt" /></label>
              <label>Program Stage <input data-field="program_stage" class="case-field" placeholder="enrolled / graduating / graduated / working" /></label>
              <label>Employment Offer <input data-field="employment_offer" class="case-field" placeholder="yes/no" /></label>
              <label>Employer Name <input data-field="employer_name" class="case-field" /></label>
              <label>Work Location <input data-field="work_location" class="case-field" /></label>
              <label>Work Start Date <input data-field="work_start_date" class="case-field" type="date" /></label>
              <label>Work End Date <input data-field="work_end_date" class="case-field" type="date" /></label>
              <label>Graduation Date <input data-field="graduation_date" class="case-field" type="date" /></label>
              <label>Petition Status <input data-field="petition_status" class="case-field" placeholder="filed / pending / unknown" /></label>
              <label>Documents Available <input data-field="documents_available" class="case-field" placeholder="i20, passport, offer_letter" /></label>
              <label>Major/Program <input data-field="major_program" class="case-field" /></label>
            </div>
            <h3>Missing Items</h3>
            <ul id="missing_items" class="list compact"></ul>
          </article>

          <article class="card">
            <h2>Full Output Package</h2>
            <div class="actions">
              <button id="generate_packet" class="primary">Generate Full Prep Packet</button>
              <button id="copy_packet">Copy Packet</button>
            </div>
            <p id="packet_status" class="subtle">Generate to produce the final advisor-ready output.</p>

            <h3>Case Summary</h3>
            <ul id="case_summary" class="list compact"></ul>

            <h3>Personalized Checklist</h3>
            <ul id="final_checklist" class="list compact"></ul>

            <h3>Timeline Plan</h3>
            <ul id="final_timeline" class="list compact"></ul>

            <h3>Questions To Ask Advisor</h3>
            <ul id="advisor_questions" class="list compact"></ul>

            <h3>Source References</h3>
            <ul id="citations" class="list compact"></ul>

            <pre id="packet_output"></pre>
          </article>
        </div>
      </section>
    </main>

    <footer class="footer shell">
      Workflow preparation assistant only. Not legal advice.
    </footer>

    <script src="/static/app.js"></script>
  </body>
</html>
